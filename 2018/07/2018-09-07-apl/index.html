<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>网鼎杯Crypto APL WriteUp | Hmmmi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
    <link rel="icon" href="/avatar-default.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/css/highlight.css">

  
  <meta name="description" content="Something about a language called APL.">
<meta property="og:type" content="article">
<meta property="og:title" content="网鼎杯Crypto APL WriteUp">
<meta property="og:url" content="https://hmmmi.github.io/2018/07/2018-09-07-apl/index.html">
<meta property="og:site_name" content="Hmmmi">
<meta property="og:description" content="Something about a language called APL.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hmmmi.github.io/imgForArc/2018/09/apl/luanma.png">
<meta property="og:image" content="https://hmmmi.github.io/imgForArc/2018/09/apl/true.png">
<meta property="og:image" content="https://hmmmi.github.io/imgForArc/2018/09/apl/%7B%7D.png">
<meta property="og:image" content="https://hmmmi.github.io/imgForArc/2018/09/apl/fei.png">
<meta property="og:image" content="https://hmmmi.github.io/imgForArc/2018/09/apl/fun1.png">
<meta property="article:published_time" content="2018-09-06T16:00:00.000Z">
<meta property="article:modified_time" content="2021-04-21T11:28:12.999Z">
<meta property="article:author" content="Hmmmi">
<meta property="article:tag" content="网鼎杯">
<meta property="article:tag" content="WriteUp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hmmmi.github.io/imgForArc/2018/09/apl/luanma.png"><meta name="generator" content="Hexo 5.1.1"></head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1 id="title">
    <a href="/">Hmmmi</a>
  </h1>
  <nav>
    
    
      
      <a class="nav-link" href="/">Home</a>
    
      
        <span class="nav-spacer">×</span>
      
      <a class="nav-link" href="/archives">Archives</a>
    
      
        <span class="nav-spacer">×</span>
      
      <a class="nav-link" target="_blank" rel="noopener" href="https://github.com/hmmmi">GitHub</a>
    
    
  </nav>
</header>

    <div id="content">
      <article id="post-2018-09-07-apl" class="article article-type-post" itemprop="blogPost" itemscope>
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 class="article-title" itemprop="headline name">
      网鼎杯Crypto APL WriteUp
    </h2>
  


        <div class="article-meta">
          <time 
		class="article-date" 
		datetime="2018-09-06T16:00:00.000Z" 
		itemprop="datePublished">
	September 7, 2018

</time>

          
            &nbsp;×&nbsp; <span class="article-word-count">563 words</span>
            
            &nbsp;×&nbsp; <span class="article-time-to-read">2 minutes</span>
            
          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
      
        <blockquote>
<p>writUp没有写完，浅尝辄止，懂了一点点，感觉也写不下去了</p>
</blockquote>
<h2 id="01-Base64解码"><a href="#01-Base64解码" class="headerlink" title="01 Base64解码"></a>01 Base64解码</h2><p>看到这样一串大小写字母跟数字混杂在一起的乱码，首先想到的肯定是Base64解码</p>
<h3 id="1-1-比赛时解码"><a href="#1-1-比赛时解码" class="headerlink" title="1-1 比赛时解码"></a>1-1 比赛时解码</h3><p>在比赛时，解码出来是一堆更乱的字符串，不过英文显示是正确的</p>
<br>

<p><img src="/imgForArc/2018/09/apl/luanma.png" alt="luanma"></p>
<br>

<p>到这一步，跟搜索出来的APL语言更是毫无联系，于是这个题目就死在了这一步</p>
<br>

<h3 id="1-2-正确的情况"><a href="#1-2-正确的情况" class="headerlink" title="1-2 正确的情况"></a>1-2 正确的情况</h3><p>后来在找到一个在线解码的网站，终于是跟某WriteUp显示的编码是一样的了，也跟APL语言中奇奇怪怪的符号联系起来了。</p>
<br>

<p><img src="/imgForArc/2018/09/apl/true.png" alt="true"></p>
<br>

<p>小白推测，之前解码出来仍是乱码的原因是APL语言的符号是非标准编码，然后大部分解码都是转成utf-8，所以会出现乱码。</p>
<h2 id="02-APL"><a href="#02-APL" class="headerlink" title="02 APL"></a>02 APL</h2><ul>
<li>函数定义用txt{···}txt来界定</li>
<li>代码从右往左执行</li>
<li>函数的参数可以有一个或两个</li>
<li>形参⍵表示右边的实参</li>
<li>形参⍺表示左边的实参</li>
</ul>
<p>函数可以表示为txt {···} txt</p>
<br>

<p><img src="/imgForArc/2018/09/apl/%7B%7D.png" alt="func"></p>
<br>

<h3 id="2-1-代码结构"><a href="#2-1-代码结构" class="headerlink" title="2-1 代码结构"></a>2-1 代码结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;⍵(~⍵)&#x2F;(&#39;No_Please_continue&#39;)(&#39;Yes,This_is_flag&#39;)&#125;</span><br><span class="line"></span><br><span class="line">(∊(41(41)0+140)(⎕UCS(&#39;µě»ÕĀ$#Ğ$èáËĞĞĝ&#96;âÞĠ#&quot;!Ġ&quot;KE(©$#Ğ$Q&lt;k&#39;))146)</span><br><span class="line">&#123;</span><br><span class="line">+&#x2F;⍺≠33+2⊥(1(5)×8)</span><br><span class="line">⍴</span><br><span class="line">∊&#123;a≠8↑(1,a←(8⍴2)⊤⍵)&#125;</span><br><span class="line">¨</span><br><span class="line">2⊥8(+&#x2F;⍴⍳(7*2)-⌊9.1⌊⍴&#39;FlagIsWhat&#39;)</span><br><span class="line">⍴</span><br><span class="line">10⊖⊖⌽</span><br><span class="line">(∊4(⍴⍴88888)+16)</span><br><span class="line">⍴</span><br><span class="line">(1+(|¯8)⍴1)</span><br><span class="line">⊤</span><br><span class="line">⎕UCS(⍵)</span><br><span class="line">&#125;</span><br><span class="line">&#39;YourFlagIsWhat?&#39;</span><br></pre></td></tr></table></figure>

<br>

<h3 id="2-2-各个函数含义"><a href="#2-2-各个函数含义" class="headerlink" title="2-2 各个函数含义"></a>2-2 各个函数含义</h3><h4 id="⍵-⍵-‘No-Please-continue’-‘Yes-This-is-flag’"><a href="#⍵-⍵-‘No-Please-continue’-‘Yes-This-is-flag’" class="headerlink" title="{⍵(~⍵)/(‘No_Please_continue’)(‘Yes,This_is_flag’)}"></a>{⍵(~⍵)/(‘No_Please_continue’)(‘Yes,This_is_flag’)}</h4><p>查阅文档，’~’的含义是’非’</p>
<br>

<p><img src="/imgForArc/2018/09/apl/fei.png" alt="~"></p>
<br>

<p>参数跟在{}后(根据之前的{} txt定义)</p>
<br>

<p><img src="/imgForArc/2018/09/apl/fun1.png" alt="~"></p>
<br>

<p>根据运行情况我们可以知道，之后的一大串代码的运算结果需要是’0’</p>
<h4 id="···-···-’YourFlagIsWhat-’"><a href="#···-···-’YourFlagIsWhat-’" class="headerlink" title="(···){···}’YourFlagIsWhat?’"></a>(···){···}’YourFlagIsWhat?’</h4><p>⍺ : (∊(41(41)0+140)(⎕UCS(‘xxx’))146)<br>⍵ : ‘YourFlagIsWhat?’<br>这段代码较长，我们逐一来看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(∊(41(41)0+140)(⎕UCS(&#39;µě»ÕĀ$#Ğ$èáËĞĞĝ&#96;âÞĠ#&quot;!Ġ&quot;KE(©$#Ğ$Q&lt;k&#39;))146)</span><br></pre></td></tr></table></figure>
<ul>
<li>∊:文档的解释是enlist</li>
<li>∊(41(41)0+140)串成一个链表即{181,181,140}</li>
<li>⎕UCS():Unicode Convert（就是将那一堆乱七八糟的东西转化成Unicode）<br>运行结果：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(∊(41(41)0+140)(⎕UCS(&#39;µě»ÕĀ$#Ğ$èáËĞĞĝ&#96;âÞĠ#&quot;!Ġ&quot;KE(©$#Ğ$Q&lt;k&#39;))146)</span><br><span class="line"></span><br><span class="line">181 181 140 181 283 187 213 256 36 35 286 36 232 225 203 286 286 285 96 226 222 288 157 35 34 33 288 34 75 69 40 169 36 35 286 36 81 60 107 146</span><br></pre></td></tr></table></figure>



<h3 id="2-3-逆向"><a href="#2-3-逆向" class="headerlink" title="2-3 逆向"></a>2-3 逆向</h3>
      
    </div>
    
    
    <div class="article-category">
      
        <b>Categories:</b>
        <a class="article-category-link" href="/categories/CTF-Crypto/">CTF-Crypto</a>
      
      
        <br/>
      
      
        <b>Tags:</b>
        <a class="article-tag-none-link" href="/tags/WriteUp/" rel="tag">WriteUp</a>, <a class="article-tag-none-link" href="/tags/%E7%BD%91%E9%BC%8E%E6%9D%AF/" rel="tag">网鼎杯</a>
      
    </div>
    
    
  </div>
</article>

  
<nav id="article-nav" class="article-nav">
  
    <a href="/2018/17/2018-09-18-twentyMarch/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          二十岁进行曲——我的大三
        
      </div>
    </a>
  
  
    <a href="/2018/01/2018-08-01-%E5%85%AB%E9%87%8C%E5%B7%B4%E9%BB%8E/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          八里巴黎
        
      </div>
    </a>
  
</nav>






    </div>
  </div>
  




<div id="settings-container">
  <div id="dark-mode">dark</div>
  <div id="sans-font">sans</div>
</div>
<script type="text/javascript">
let d=document,r=d.documentElement.style,f=r.setProperty.bind(r),l=localStorage,s=l.getItem('s')||(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches),n=l.getItem('n'),m=d.getElementById("dark-mode"),b=()=>{f('--bg-color','#fafafa');f('--code-bg-color','#f4f4f4');f('--text-color','#212121');f('--secondary-color','#808080');f('--tertiary-color','#b0b0b0');f('--link-color','#b5c8cf');f('--link-hover-color','#618794');f('--link-bg-color','#dae4e7');f('--selection-color','#dae4e7');m.innerHTML="dark"},c=()=>{f('--bg-color','#212121');f('--code-bg-color','#292929');f('--text-color','#fff');f('--secondary-color','#c0c0c0');f('--tertiary-color','#6e6e6e');f('--link-color','#4d6b75');f('--link-hover-color','#96b1bb');f('--link-bg-color','#5d828e');f('--selection-color','#acc1c9');m.innerHTML="light"},o=d.getElementById("sans-font"),e=()=>{f('--body-stack','"Lora", "Georgia", "Times New Roman", serif');o.innerHTML="sans"},g=()=>{f('--body-stack','"Lato", "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", "Verdana", sans-serif');o.innerHTML="serif"};m.onclick=()=>{if(s==2){s=1;l.setItem('s',s);c()}else{s=2;l.setItem('s',s);b()}};o.onclick=()=>{if(n==2){n=1;l.setItem('n',n);g()}else{n=2;l.setItem('n',n);e()}};if(!s){s=2;l.setItem('s',2)};if(s==1){c()};if(!n){n=2;l.setItem('n',2)};if(n==1){g()};
</script>



<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-195210058-2', 'auto');
ga('send', 'pageview');
</script>


</body>
</html>
